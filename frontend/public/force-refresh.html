<!DOCTYPE html>
<html>
<head>
    <title>üö® CACHE BUSTING EMERGENCY</title>
    <style>
        body { 
            font-family: Arial; 
            background: #ffebee; 
            padding: 20px; 
            text-align: center; 
        }
        .emergency { 
            background: #f44336; 
            color: white; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0; 
        }
        .success { 
            background: #4caf50; 
            color: white; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 10px 0; 
        }
        button { 
            background: #2196f3; 
            color: white; 
            border: none; 
            padding: 15px 30px; 
            font-size: 16px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 10px; 
        }
        button:hover { background: #1976d2; }
    </style>
</head>
<body>
    <div class="emergency">
        <h1>üö® EMERGENCY CACHE CLEAR</h1>
        <p>Loop infinito de logs detectado!</p>
        <p>Cache do browser precisa ser limpo IMEDIATAMENTE</p>
    </div>
    
    <div class="success" id="status">
        ‚è≥ Aguardando a√ß√£o do usu√°rio...
    </div>
    
    <button onclick="clearAllCache()">üîÑ LIMPAR CACHE AGRESSIVO</button>
    <button onclick="forceReload()">‚ö° RELOAD FOR√áADO</button>
    <button onclick="goToApp()">üè† VOLTAR √Ä APLICA√á√ÉO</button>
    
    <script>
        function clearAllCache() {
            const status = document.getElementById('status');
            status.innerHTML = 'üîÑ Limpando cache...';
            
            // Clear all storages
            try {
                localStorage.clear();
                sessionStorage.clear();
                status.innerHTML = '‚úÖ Storage limpo...';
            } catch (e) {
                console.error('Erro ao limpar storage:', e);
            }
            
            // Clear Service Workers
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(registration => {
                        registration.unregister();
                    });
                    status.innerHTML = '‚úÖ Service Workers limpos...';
                });
            }
            
            // Clear Cache API
            if ('caches' in window) {
                caches.keys().then(cacheNames => {
                    cacheNames.forEach(cacheName => {
                        caches.delete(cacheName);
                    });
                    status.innerHTML = '‚úÖ Cache API limpo...';
                });
            }
            
            setTimeout(() => {
                status.innerHTML = 'üéâ CACHE COMPLETAMENTE LIMPO!';
            }, 2000);
        }
        
        function forceReload() {
            window.location.href = window.location.origin + '?cb=' + Date.now();
        }
        
        function goToApp() {
            window.location.href = '/app/vendedor/cadastrar?cb=' + Date.now();
        }
        
        // Auto-clear after 3 seconds
        setTimeout(() => {
            clearAllCache();
        }, 3000);
    </script>
</body>
</html>
